---
import TabPanel from '@components/ui/tabs/TabPanel.astro'
import Tabs from '@components/ui/tabs/Tabs.astro'
import type { TabsItems } from '@components/ui/tabs/tabs.types'
import type { CategorizedPosts } from '@libs/application/dtos/post'

import PostList from './PostList.astro'

interface Props {
  categorizedPosts: CategorizedPosts
}

const { categorizedPosts } = Astro.props

const defaultTabs = [
  { id: 'All', label: 'All' },
  { id: 'Tech', label: 'Tech' },
  { id: 'Finance', label: 'Finance' },
  { id: 'Other', label: 'Other' },
]

const getTabsFromPosts = () => {
  const tabs: TabsItems = []
  categorizedPosts.forEach((categorizedPost) => {
    tabs.push({
      id: categorizedPost.category,
      label: categorizedPost.category,
    })
  })

  if (tabs.length === 0) return defaultTabs

  return tabs
}
---

<Tabs tabs={getTabsFromPosts()} additionalClass="flex justify-center mb-8">
  {
    categorizedPosts.map((categorizedPost) => (
      <TabPanel id={categorizedPost.category} active={categorizedPost.category === 'All'}>
        <PostList posts={categorizedPost.posts} />
      </TabPanel>
    ))
  }
</Tabs>
